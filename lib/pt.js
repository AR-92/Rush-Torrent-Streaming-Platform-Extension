/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/parse-torrent-file@4.2.2/index.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
module.exports=decodeTorrentFile,module.exports.decode=decodeTorrentFile,module.exports.encode=encodeTorrentFile;var bencode=require("bencode"),path=require("path"),sha1=require("simple-sha1"),uniq=require("uniq");function decodeTorrentFile(e){Buffer.isBuffer(e)&&(e=bencode.decode(e)),ensure(e.info,"info"),ensure(e.info["name.utf-8"]||e.info.name,"info.name"),ensure(e.info["piece length"],"info['piece length']"),ensure(e.info.pieces,"info.pieces"),e.info.files?e.info.files.forEach(function(e){ensure("number"==typeof e.length,"info.files[0].length"),ensure(e["path.utf-8"]||e.path,"info.files[0].path")}):ensure("number"==typeof e.info.length,"info.length");var n={};n.info=e.info,n.infoBuffer=bencode.encode(e.info),n.infoHash=sha1.sync(n.infoBuffer),n.infoHashBuffer=Buffer.from(n.infoHash,"hex"),n.name=(e.info["name.utf-8"]||e.info.name).toString(),void 0!==e.info.private&&(n.private=!!e.info.private),e["creation date"]&&(n.created=new Date(1e3*e["creation date"])),e["created by"]&&(n.createdBy=e["created by"].toString()),Buffer.isBuffer(e.comment)&&(n.comment=e.comment.toString()),n.announce=[],Array.isArray(e["announce-list"])&&e["announce-list"].length>0?e["announce-list"].forEach(function(e){e.forEach(function(e){n.announce.push(e.toString())})}):e.announce&&n.announce.push(e.announce.toString()),Buffer.isBuffer(e["url-list"])&&(e["url-list"]=e["url-list"].length>0?[e["url-list"]]:[]),n.urlList=(e["url-list"]||[]).map(function(e){return e.toString()}),uniq(n.announce),uniq(n.urlList);var t=e.info.files||[e.info];n.files=t.map(function(e,i){var r=[].concat(n.name,e["path.utf-8"]||e.path||[]).map(function(e){return e.toString()});return{path:path.join.apply(null,[path.sep].concat(r)).slice(1),name:r[r.length-1],length:e.length,offset:t.slice(0,i).reduce(sumLength,0)}}),n.length=t.reduce(sumLength,0);var i=n.files[n.files.length-1];return n.pieceLength=e.info["piece length"],n.lastPieceLength=(i.offset+i.length)%n.pieceLength||n.pieceLength,n.pieces=splitPieces(e.info.pieces),n}function encodeTorrentFile(e){var n={info:e.info};return n["announce-list"]=(e.announce||[]).map(function(e){return n.announce||(n.announce=e),[e=Buffer.from(e,"utf8")]}),n["url-list"]=e.urlList||[],!0!==e.private&&!1!==e.private||(n.private=e.private),e.created&&(n["creation date"]=e.created.getTime()/1e3|0),e.createdBy&&(n["created by"]=e.createdBy),e.comment&&(n.comment=e.comment),bencode.encode(n)}function sumLength(e,n){return e+n.length}function splitPieces(e){for(var n=[],t=0;t<e.length;t+=20)n.push(e.slice(t,t+20).toString("hex"));return n}function ensure(e,n){if(!e)throw new Error("Torrent is missing required field: "+n)}
//# sourceMappingURL=/sm/45b9eb46cbd579dd38ddcc2bfd7ab1fd0ad310bf5adf2cacff94ba3014b0f195.map